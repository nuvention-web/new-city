{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Semantic - Minimal portfolio template</title>

  <link rel="stylesheet" href="{% static 'assets/css/jquery-ui.css' %}">


  <!-- Bootstrap core CSS -->
  <link href="{% static 'assets/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">

  <!-- Plugins -->
  <link href="{% static 'assets/css/simpletextrotator.css' %}" rel="stylesheet">
  <link href="{% static 'assets/css/font-awesome.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/css/et-line-font.css' %}" rel="stylesheet">
  <link href="{% static 'assets/css/magnific-popup.css' %}" rel="stylesheet">
  <link href="{% static 'assets/css/flexslider.css' %}" rel="stylesheet">
  <link href="{% static 'assets/css/animate.css' %}" rel="stylesheet">

  <!-- Template core CSS -->
  <link href="{% static 'assets/css/style.css' %}" rel="stylesheet">

  <!-- Custom css -->
  <link href="{% static 'assets/css/custom.css' %}" rel="stylesheet">
</head>
<body>

  <!-- PRELOADER -->
  <div class="page-loader">
    <div class="loader">Loading...</div>
  </div>
  <!-- /PRELOADER -->

  <!-- NAVIGATION -->
  <nav class="navbar navbar-custom navbar-transparent navbar-fixed-top" role="navigation">

      <div class="container">

        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#custom-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Semantic</a>
        </div>

        <div class="collapse navbar-collapse" id="custom-collapse">

          <ul class="nav navbar-nav navbar-right">

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Home</a>
              <ul class="dropdown-menu">
                <li><a href="index.html">Image Parallax 1</a></li>
                <li><a href="index-2.html">Image Parallax 2</a></li>
                <li><a href="index-3.html">Slider Parallax 1</a></li>
                <li><a href="index-4.html">Slider Parallax 2</a></li>
                <li><a href="index-5.html">Text rotator 1</a></li>
                <li><a href="index-6.html">Text rotator 2</a></li>
                <li><a href="index-7.html">Video background 1</a></li>
                <li><a href="index-8.html">Video background 2</a></li>
              </ul>
            </li>

            <li><a href="about.html">About</a></li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Portfolio</a>
              <ul class="dropdown-menu" role="menu">

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Boxed</a>
                  <ul class="dropdown-menu">
                    <li><a href="portfolio-boxed-col2.html">2 Columns</a></li>
                    <li><a href="portfolio-boxed-col3.html">3 Columns</a></li>
                    <li><a href="portfolio-boxed-col4.html">4 Columns</a></li>
                    <li><a href="portfolio-boxed-hover-black.html">Hover Black</a></li>
                    <li><a href="portfolio-boxed-hover-gradient.html">Hover Gradient</a></li>
                  </ul>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Boxed - Gutter</a>
                  <ul class="dropdown-menu">
                    <li><a href="portfolio-boxed-gutter-col2.html">2 Columns</a></li>
                    <li><a href="portfolio-boxed-gutter-col3.html">3 Columns</a></li>
                    <li><a href="portfolio-boxed-gutter-col4.html">4 Columns</a></li>
                    <li><a href="portfolio-boxed-gutter-hover-black.html">Hover Black</a></li>
                    <li><a href="portfolio-boxed-gutter-hover-gradient.html">Hover Gradient</a></li>
                  </ul>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Boxed - Masonry</a>
                  <ul class="dropdown-menu">
                    <li><a href="portfolio-boxed-masonry-col2.html">2 Columns</a></li>
                    <li><a href="portfolio-boxed-masonry-col3.html">3 Columns</a></li>
                    <li><a href="portfolio-boxed-masonry-col4.html">4 Columns</a></li>
                    <li><a href="portfolio-boxed-masonry-hover-black.html">Hover Black</a></li>
                    <li><a href="portfolio-boxed-masonry-hover-gradient.html">Hover Gradient</a></li>
                  </ul>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Wide</a>
                  <ul class="dropdown-menu">
                    <li><a href="portfolio-wide-col2.html">2 Columns</a></li>
                    <li><a href="portfolio-wide-col3.html">3 Columns</a></li>
                    <li><a href="portfolio-wide-col4.html">4 Columns</a></li>
                    <li><a href="portfolio-wide-hover-black.html">Hover Black</a></li>
                    <li><a href="portfolio-wide-hover-gradient.html">Hover Gradient</a></li>
                  </ul>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Wide - Gutter</a>
                  <ul class="dropdown-menu">
                    <li><a href="portfolio-wide-gutter-col2.html">2 Columns</a></li>
                    <li><a href="portfolio-wide-gutter-col3.html">3 Columns</a></li>
                    <li><a href="portfolio-wide-gutter-col4.html">4 Columns</a></li>
                    <li><a href="portfolio-wide-gutter-hover-black.html">Hover Black</a></li>
                    <li><a href="portfolio-wide-gutter-hover-gradient.html">Hover Gradient</a></li>
                  </ul>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Wide - Masonry</a>
                  <ul class="dropdown-menu">
                    <li><a href="portfolio-wide-masonry-col2.html">2 Columns</a></li>
                    <li><a href="portfolio-wide-masonry-col3.html">3 Columns</a></li>
                    <li><a href="portfolio-wide-masonry-col4.html">4 Columns</a></li>
                    <li><a href="portfolio-wide-masonry-hover-black.html">Hover Black</a></li>
                    <li><a href="portfolio-wide-masonry-hover-gradient.html">Hover Gradient</a></li>
                  </ul>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Single</a>
                  <ul class="dropdown-menu">
                    <li><a href="portfolio-single-1.html">Single 1</a></li>
                    <li><a href="portfolio-single-2.html">Single 2</a></li>
                    <li><a href="portfolio-single-3.html">Single 3</a></li>
                    <li><a href="portfolio-single-4.html">Single 4</a></li>
                    <li><a href="portfolio-single-5.html">Single 5</a></li>
                    <li><a href="portfolio-single-6.html">Single 6</a></li>
                    <li><a href="portfolio-single-7.html">Single 7</a></li>
                  </ul>
                </li>

              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Blog</a>
              <ul class="dropdown-menu" role="menu">

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Grid</a>
                  <ul class="dropdown-menu">
                    <li><a href="blog-grid-2col.html">2 Columns</a></li>
                    <li><a href="blog-grid-3col.html">3 Columns</a></li>
                    <li><a href="blog-grid-4col.html">4 Columns</a></li>
                  </ul>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Standart</a>
                  <ul class="dropdown-menu">
                    <li><a href="blog-standart-1.html">Standart 1</a></li>
                    <li><a href="blog-standart-2.html">Standart 2</a></li>
                  </ul>
                </li>

                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Single</a>
                  <ul class="dropdown-menu">
                    <li><a href="blog-single.html">Single 1</a></li>
                    <li><a href="blog-single-2.html">Single 2</a></li>
                  </ul>
                </li>

              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features</a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="comp-alerts-wells.html"><i class="fa fa-bolt"></i> Alerts and Wells</a></li>
                <li><a href="comp-buttons.html"><i class="fa fa-link fa-sm"></i> Buttons</a></li>
                <li><a href="comp-collapses-tabs.html"><i class="fa fa-tasks"></i> Collapses &amp; Tabs</a></li>
                <li><a href="comp-content-box.html"><i class="fa fa-list-alt"></i> Contents Box</a></li>
                <li><a href="comp-forms.html"><i class="fa fa-check-square-o"></i> Forms</a></li>
                <li><a href="comp-icons.html"><i class="fa fa-star"></i> Icons</a></li>
                <li><a href="comp-progress-bars.html"><i class="fa fa-server"></i> Progress Bars</a></li>
                <li><a href="comp-typography.html"><i class="fa fa-font"></i> Typography</a></li>
              </ul>
            </li>

            <li><a href="contact.html">Contact</a></li>

          </ul>
        </div>

      </div>

  </nav>
  <!-- /NAVIGATION -->

  <!-- WRAPPER -->
  <div class="wrapper">

    <!-- HOME -->
    <section class="module module-header bg-dark bg-dark-50" data-background="{% static 'assets/images/section-1.jpg' %}">

      <div class="container">

        <!-- MODULE TITLE -->
        <div class="row">

          <div class="col-sm-6 col-sm-offset-3">

            <h1 class="module-title font-alt align-center">Find your roommate</h1>

            <div class="module-subtitle font-inc align-center">
              {% if initial_city %}
              {{ initial_city }}
              {% endif %}
            </div>

          </div>

        </div>
        <!-- /MODULE TITLE -->

      </div>

    </section >
    <!-- /HOME -->

    <!-- PORTFOLIO -->
    <section class="module-small p-t-20 p-b-60">

      <div class="container">

 <!-- PORTFOLIO FILTER -->
        <div class="row">
          <div class="col-sm-12">

            <ul id="filters" class="filter font-inc hidden-xs">
              <li>
              <div id="div-gender">
                  <input type="checkbox" class = "gender-class" name="filter-gender" value="M" /> Male <br>
                  <input type="checkbox" class = "gender-class" name="filter-gender" value="F" /> Female
              </div>
              </li>

              <li>
              <div id="div-relationship">
              <input type="checkbox" class="filter-relationship" value="S"> Single<br>
              <input type="checkbox" class="filter-relationship" value="E"> Engaged<br>
              <input type="checkbox" class="filter-relationship" value="M"> Married<br>
              <input type="checkbox" class="filter-relationship" value="I"> In a relationship<br>
              </div>
              </li>

              <li>
              <form method='GET' action="" id="filter-school-form">{% csrf_token %}
                School: <input type="text" id="text-school">
                <input id = "input-school" type="submit" value="Search School"><br>
              </form>
              </li>

              <li>
                <p>
                  <label for="amount">Monthly budget:</label>
                  <input type="text" id="amount-budget" readonly>
                </p>
                <div id="budget-range"></div>
              </li>

              <li>
              <p>
                <label for="amount">Age range:</label>
                <input type="text" id="text-age" readonly>
              </p>
              <div id="age-range"></div>
              </li>


              <li>
                <div id="div-tag">
                <br>
                {% for tag in tag_list %}
                <input type="checkbox" class="filter-tag" value="{{ tag.name }}"> {{ tag.name }}
                {% endfor %}
                </div>
              </li>
              <li>
                <form method='GET' action="" id="reset-form">{% csrf_token %}
                <input id = "reset" type="submit" value="Reset">
              </form>
              </li>
            </ul>

          </div>
        </div>
        <!-- /PORTFOLIO FILTER -->

        <!-- PORTFOLIO LIST -->
        <ul id="works-grid" class="works-grid works-grid-gut works-grid-2 works-hover-w">

        <div id="output" class="output">

        {% for roommate in roommate_list %}

          <li class="work-item illustration webdesign">
            <a href="portfolio-single-1.html">
              <div class="work-image">
                <!-- <img src="{% static 'assets/images/work-1.jpg' %}" alt=""> -->
                <h3 class="work-title font-alt">{{ roommate.user.username }}</h3>
                <div class="work-descr font-inc">

                  Gender: {{ roommate.gender }}</br>
                  School: {{ roommate.school }}</br>
                  Age: {{ roommate.birthday }}
                  Hometown: {{ roommate.hometown }}</br>
                  Job: {{ roommate.job }}</br>
                  Budget: {{ roommate.budget }}</br>
                  Age: {{ roommate.age }}</br>
                  Relationship Status: {{ roommate.get_relationship_status_display }}</br>
                  Tags:
                  {% for tag in roommate.tags.all %}
                    {{ tag.name }},
                  {% endfor %}

                </div>
              </div>
            </a>
          </li>

        {% endfor %}

          </div>

          <!-- PORTFOLIO ITEM -->
          <li class="work-item marketing webdesign">
            <a href="portfolio-single-1.html">
              <div class="work-image">
                <img src="{% static 'assets/images/work-6.jpg' %}" alt="">
              </div>
              <div class="work-caption">
                <h3 class="work-title font-alt">Business Cards in paper clip</h3>
                <div class="work-descr font-inc">
                  Marketing
                </div>
              </div>
            </a>
          </li>
          <!-- /PORTFOLIO ITEM -->
        </ul>
        <!-- /PORTFOLIO LIST -->

      </div>

    </section>
    <!-- /PORTFOLIO -->

    <!-- PAGINATION -->
    <section class="module-small p-t-0">

      <div class="container">

        <div class="pagination font-inc text-uppercase">

          <a href="#"><i class="fa fa-angle-left"></i> Prev</a>
          <a href="#">Next <i class="fa fa-angle-right"></i></a>

        </div>

      </div>

    </section>
    <!-- /PAGINATION -->

    <!-- DIVIDER -->
    <hr class="divider-w">
    <!-- /DIVIDER -->

    <!-- CONTACT -->
    <section class="module-small">

      <div class="container">

        <div class="row">

          <!-- CONTENT BOX -->
          <div class="col-sm-4">
            <div class="content-box">
              <div class="content-box-icon">
                <span class="icon-map-pin"></span>
              </div>
              <div class="content-box-title font-inc">
                007 Steet, City, USA
              </div>
            </div>
          </div>
          <!-- /CONTENT BOX -->

          <!-- CONTENT BOX -->
          <div class="col-sm-4">
            <div class="content-box">
              <div class="content-box-icon">
                <span class="icon-phone"></span>
              </div>
              <div class="content-box-title font-inc">
                +1 234 567 89 00
              </div>
            </div>
          </div>
          <!-- /CONTENT BOX -->

          <!-- CONTENT BOX -->
          <div class="col-sm-4">
            <div class="content-box">
              <div class="content-box-icon">
                <span class="icon-envelope"></span>
              </div>
              <div class="content-box-title font-inc">
                semantic@email.com
              </div>
            </div>
          </div>
          <!-- /CONTENT BOX -->

        </div>

      </div>

    </section>
    <!-- /CONTACT -->

    <!-- FOOTER -->
    <footer class="footer">

      <div class="container">

        <div class="row">

          <div class="col-sm-12 text-center">
            <p class="copyright font-inc m-b-0">© 2015 <a href="index.html">SEMANTIC</a>, All Rights Reserved.</p>
          </div>

        </div>

      </div>

    </footer>
    <!-- /FOOTER -->

  </div>
  <!-- /WRAPPER -->

  <!-- Scroll-up -->
  <div class="scroll-up">
    <a href="#totop"><i class="fa fa-angle-double-up' %}"></i></a>
  </div>

  <!-- Javascript files -->
  <script src="{% static 'assets/js/jquery-2.1.3.min.js' %}"></script>
  <script src="{% static 'assets/bootstrap/js/bootstrap.min.js' %}"></script>
  <script src="{% static 'assets/js/jquery.mb.YTPlayer.min.js' %}"></script>
  <script src="{% static 'assets/js/appear.js' %}"></script>
  <script src="{% static 'assets/js/jquery.simple-text-rotator.min.js' %}"></script>
  <script src="{% static 'assets/js/jqBootstrapValidation.js' %}"></script>
  <script src="http://maps.google.com/maps/api/js?sensor=true' %}"></script>
  <script src="{% static 'assets/js/gmaps.js' %}"></script>
  <script src="{% static 'assets/js/isotope.pkgd.min.js' %}"></script>
  <script src="{% static 'assets/js/imagesloaded.pkgd.js' %}"></script>
  <script src="{% static 'assets/js/jquery.flexslider-min.js' %}"></script>
  <script src="{% static 'assets/js/jquery.magnific-popup.min.js' %}"></script>
  <script src="{% static 'assets/js/jquery.fitvids.js' %}"></script>
  <script src="{% static 'assets/js/smoothscroll.js' %}"></script>
  <script src="{% static 'assets/js/wow.min.js' %}"></script>
  <script src="{% static 'assets/js/contact.js' %}"></script>
  <script src="{% static 'assets/js/custom.js' %}"></script>
  <script src="{% static 'assets/js/jquery-1.11.1.js' %}"></script>
  <script src="{% static 'assets/js/jquery-ui-1.11.4.js' %}"></script>

     <script>

    $(function() {
    $("#budget-range").slider({
      range: true,
      min: 0,
      max: 5000,
      step: 100,
      values: [ 0, 5000 ],
      slide: function( event, ui )  {
        $("#amount-budget").val("$" + ui.values[0] + " - $" + ui.values[1]);
      },
      stop: function(event, ui) {
        filter_roommate()
      }
    });
    $("#amount-budget").val("$" + $("#budget-range").slider("values", 0) + " - $" + $("#budget-range").slider("values", 1));
  });

    $(function() {
    $("#age-range").slider({
      range: true,
      min: 0,
      max: 100,
      step: 1,
      values: [ 0, 100 ],
      slide: function( event, ui )  {
        $("#text-age").val(ui.values[0] + " - " + ui.values[1]);
      },
      stop: function(event, ui) {
        filter_roommate()
      }
    });
    $("#text-age").val($("#age-range").slider("values", 0) + " - " + $("#age-range").slider("values", 1));
  });

    // $('.gender-class').on('submit', function(event){
    $(".gender-class").click(function(event){
        console.log("form submitted!")  // sanity check
        filter_roommate();
    });

    $(".filter-relationship").click(function(event){
        console.log("form submitted!")  // sanity check
        filter_roommate();
    });

    $(".filter-tag").click(function(event){
        console.log("form submitted!")  // sanity check
        filter_roommate();
    });

    $("#filter-hometown-form").on('submit', function(event){
        event.preventDefault();
        console.log("form submitted!")  // sanity check
        filter_roommate();
    });

    $("#filter-school-form").on('submit', function(event){
        event.preventDefault();
        console.log("form submitted!")  // sanity check
        filter_roommate();
    });

    $("#filter-job-form").on('submit', function(event){
        event.preventDefault();
        console.log("form submitted!")  // sanity check
        filter_roommate();
    });

    $("#reset-form").on('submit', function(event){
        // event.preventDefault();
        location.reload()
    });

    function filter_roommate() {
    console.log("filter_roommate is working!") // sanity check
    var budget = $("#budget-range").slider( "option", "values" )
    var age = $("#age-range").slider("option", "values")
    var gender_selected = []
    var relationship_selected = [];
    var filter_selected = [];
    $('#div-gender input:checked').each(function() {
      gender_selected.push($(this).val());
    });
    $('#div-relationship input:checked').each(function() {
      relationship_selected.push($(this).val());
    });

    $('#div-tag input:checked').each(function() {
      filter_selected.push($(this).val());
    });

    $.ajax({
        url : window.location.pathname,
        //"/posts/list_roommate/San%20Francisco"
        type : "GET", // http method
        // data : { gender : $('#filter-gender').val()
        data : { gender : gender_selected,
               hometown: $("#text-hometown").val(),
               school: $("#text-school").val(),
               job: $("#text-job").val(),
               budget_low: budget[0],
               budget_high: budget[1],
               age_low: age[0],
               age_high: age[1],
               relationship_status: relationship_selected,
               filter_selected: filter_selected,
                }, // data sent with the post request

        // handle a successful response
        success : function(json) {
            // $('#filter-gender').val(''); // remove the value from the input
            console.log(json); // log the returned json to the console
            console.log("success"); // another sanity check
            // $(document).ajaxStop(function() { location.reload(true); });
            // window.location.reload(json)
            var raw_html = document.createElement('html')
            raw_html.innerHTML = json
            // var output = raw_html.firstChild;
            var output = raw_html.getElementsByClassName("output")[0]
            $(".output").html(output)
            // .html(json)
            },

        // handle a non-successful response
        error : function(xhr,errmsg,err) {
            $('#results').html("<div class='alert-box alert radius' data-alert>Oops! We have encountered an error: "+errmsg+
                " <a href='#' class='close'>&times;</a></div>"); // add the error to the dom
            console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
            }
        });
    };
  </script>

</body>
</html>
